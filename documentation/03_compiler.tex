\section{Framework Usage}
In order to generate target code for a \ac{GPU} accelerator, the user invokes the \verb|hipacc| compiler providing an input file and specifying the output file using the \verb|-o <file>| option.
In addition, the \verb|-compute-capability <n>| option specifies the target hardware. Supported devices are listed in Table~\ref{tab:cc}.

\subsection{Optimization Selection}
The code variant (i.\,e., combination of optimizations) for a particular target device is automatically chosen by the \ac{HIPAcc} framework according to an expert system and based on heuristics.
For manual testing, the user can enable or disable optimizations using corresponding command line options.
For example, the user can specify that local memory or texture memory should be turned on or off.
Similar, the amount of padding or the unroll factor can be set by the user.
The \verb|--time-kernels| compiler flag generates code that executes each kernel 10 times for calculating the execution time.
This timing information (in ms) can be retrieved for the kernel executed last using the \verb|hipaccGetLastKernelTiming()| function.

Below, all options of the source-to-source compiler are listed.

\lstset{language=bash}
\begin{code}
membarth@codesign75:~/projects/hipacc/build/release/bin > ./hipacc --help

Copyright (c) 2012, University of Erlangen-Nuremberg
Copyright (c) 2012, Siemens AG
Copyright (c) 2010, ARM Limited
All rights reserved.

OVERVIEW: HIPAcc - Heterogeneous Image Processing Acceleration framework

USAGE:  hipacc [options] <input>

OPTIONS:

  -emit-cuda              Emit CUDA code; default is OpenCL code
  -emit-opencl-x86        Emit OpenCL code for x86 devices, no padding supported
  -emit-padding <n>       Emit CUDA/OpenCL image padding, using alignment of <n> bytes for GPU devices
  -compute-capability <n> Generate code for GPUs with compute capability <n>.
                          Valid values for CUDA/OpenCL on NVIDIA devices are 10, 11, 12, 13, 20, 21, 30, and 35
                          Valid values for OpenCL on AMD devices is 58 and 69
  -explore-config         Emit code that explores all possible kernel configuration and print its performance
  -use-config <nxm>       Emit code that uses a configuration of nxm threads, e.g. 128x1
  -time-kernels           Emit code that executes each kernel multiple times to get accurate timings
  -use-textures <o>       Enable/disable usage of textures (cached) in CUDA/OpenCL to read/write image pixels - for GPU devices only
                          Valid values for CUDA on NVIDIA devices: 'off', 'Linear1D', 'Linear2D', and 'Array2D'
                          Valid values for CUDA on NVIDIA devices: 'off' and 'Array2D'
  -use-local <o>          Enable/disable usage of shared/local memory in CUDA/OpenCL to stage image pixels to scratchpad
                          Valid values: 'on' and 'off'
  -vectorize <o>          Enable/disable vectorization of generated CUDA/OpenCL code
                          Valid values: 'on' and 'off'
  -pixels-per-thread <n>  Specify how many pixels should be calculated per thread
  -o <file>               Write output to <file>
  --help                  Display available options
  --version               Display version information
\end{code}


\subsection{Sample Invocation}
The installation of the \ac{HIPAcc} framework provides a set of example programs and a Makefile for getting started easily.
The installation directory contains the \verb|tests| directory with sample programs.
Setting the {\tt TEST\_CASE} environment variable to one of these directories and the {\tt C\_C} for the graphics card in the system is all to get started.
Afterwards, the \verb|make cuda| and \verb|make opencl| targets can be used to generate code using the CUDA and OpenCL back ends, respectively.

\begin{itemize}
    \item TEST\_CASE: directory of the example that should be compiled using the
    \ac{HIPAcc} compiler.
    \item C\_C: specified the compute capability for which the compiler should optimize for
\end{itemize}

Here are sample definition of these variables:
\begin{code}
# compile the bilateral filter example
export TEST_CASE=./tests/bilateral_filter

# generate target code for a Quadro FX 5800 graphics card from NVIDIA
export C_C=13
\end{code}

\subsection{Supported Target Hardware}
The target hardware as supported by \ac{HIPAcc} is categorized according to a
compute capability. The compute capability corresponds 1:1 to the compute
capability for NVIDIA GPUs and corresponds to the series specification for AMD
GPUs. Table~\ref{tab:cc} lists the devices currently supported by the
\ac{HIPAcc} framework.

%\ctable[pos=hb, caption={Compute capabilities and sample GPU devices supported by the compiler.},label={tab:cc}]{ll}{}{
%\FL
%compute capability  & supported devices \ML
%10                  & NVIDIA GeForce 8800 GTX, 9800 GT, Tesla C870 \NN
%11                  & NVIDIA GeForce 8800 GTS, 9800 GTX \NN
%12                  & NVIDIA GeForce GT 240 \NN
%13                  & NVIDIA GeForce GTX 285, Tesla C1060 \NN
%20                  & NVIDIA GeForce GTX 590, Tesla C2050 \NN
%21                  & NVIDIA GeForce GTX 560 Ti \NN
%30                  & NVIDIA GeForce GTX 680 \NN
%35                  & Not yet announced. \ML
%58                  & AMD Radeon HD 58xx \NN
%69                  & AMD Radeon HD 69xx \LL
%}
\begin{table}
    \centering
    \begin{tabular}{ll}
\hline
compute capability\qquad& supported devices \\
\hline
10                      & NVIDIA GeForce 8800 GTX, 9800 GT, Tesla C870 \\
11                      & NVIDIA GeForce 8800 GTS, 9800 GTX \\
12                      & NVIDIA GeForce GT 240 \\
13                      & NVIDIA GeForce GTX 285, Tesla C1060 \\
20                      & NVIDIA GeForce GTX 590, Tesla C2050 \\
21                      & NVIDIA GeForce GTX 560 Ti \\
30                      & NVIDIA GeForce GTX 680 \\
35                      & Not yet announced. \\
\hline
58                      & AMD Radeon HD 58xx \\
69                      & AMD Radeon HD 69xx \\
\hline
    \end{tabular}
    \caption{Compute capabilities and sample GPU devices supported by the
    \ac{HIPAcc} framework.}\label{tab:cc}
\end{table}

